<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CarUsed - Vehicle History Reports</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Lexend:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Stripe Buy Button SDK -->
    <script async src="https://js.stripe.com/v3/buy-button.js"></script>
    
    <style>
        :root {
            --primary-color: #0A2463;
            --secondary-color: #D9A273;
            --bg-color: #F8F9FA;
            --surface-color: #FFFFFF;
            --heading-color: #1a202c;
            --text-color: #4a5568;
            --border-color: #e2e8f0;
            --success-color: #10b981;
            --danger-color: #ef4444;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Lexend', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.7;
            overflow-x: hidden;
            padding-top: 95px;
        }

        h1, h2, h3, h4, h5, h6 {
            font-family: 'Lexend', sans-serif;
            color: var(--heading-color);
            font-weight: 600;
        }

        .btn {
            transition: all 0.3s ease;
            font-weight: 500;
            letter-spacing: 0.5px;
            border-radius: 8px;
            padding: 12px 30px;
            font-size: 0.95rem;
        }

        .btn-primary {
            background-color: var(--primary-color);
            border-color: var(--primary-color);
            box-shadow: 0 4px 6px rgba(10, 36, 99, 0.1);
        }

        .btn-primary:hover {
            background-color: #081c4a;
            border-color: #081c4a;
            transform: translateY(-3px);
            box-shadow: 0 7px 14px rgba(10, 36, 99, 0.2);
        }

        .section-padding {
            padding: 80px 0;
        }

        .section-title {
            margin-bottom: 40px;
        }
        .section-title h2 {
            font-size: 2.5rem;
            font-weight: 600;
            position: relative;
            display: inline-block;
            padding-bottom: 20px;
            line-height: 1.3;
        }
        .section-title h2::after {
            content: '';
            position: absolute;
            left: 0;
            bottom: 0;
            width: 60px;
            height: 5px;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
            border-radius: 5px;
        }

        /* Navbar Styling */
        .navbar {
            padding: 15px 0;
            background-color: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            border-bottom: 1px solid var(--border-color);
            z-index: 1040;
        }
        .navbar-brand {
            font-weight: 600;
            font-size: 1.6rem;
            color: var(--heading-color) !important;
        }
        .navbar-brand span {
            color: var(--secondary-color);
        }
        .nav-link {
            color: var(--heading-color) !important;
            font-weight: 500;
            margin: 0 10px;
            transition: color 0.3s ease;
        }
        .nav-link:hover {
            color: var(--secondary-color) !important;
        }

        /* VIN Search Section */
        .vin-search-section {
            background: linear-gradient(135deg, var(--primary-color) 0%, #1a3a8f 100%);
            color: white;
            padding: 100px 0;
            border-radius: 0 0 20px 20px;
        }

        .vin-search-container {
            max-width: 800px;
            margin: 0 auto;
            text-align: center;
        }

        .vin-search-container h1 {
            color: white;
            font-size: 3rem;
            margin-bottom: 20px;
        }

        .vin-search-container p {
            font-size: 1.2rem;
            opacity: 0.9;
            margin-bottom: 40px;
        }

        .vin-form {
            display: flex;
            gap: 15px;
            margin: 30px 0;
        }

        .vin-input {
            flex: 1;
            padding: 18px 25px;
            border: none;
            border-radius: 10px;
            font-size: 1.1rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        /* Validation Message */
        .validation-message {
            margin-top: 20px;
            padding: 15px;
            border-radius: 10px;
            display: none;
            text-align: left;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .validation-message.valid {
            background-color: rgba(209, 250, 229, 0.9);
            color: #065f46;
            border-left: 5px solid var(--success-color);
            display: block;
        }

        .validation-message.invalid {
            background-color: rgba(254, 226, 226, 0.9);
            color: #991b1b;
            border-left: 5px solid var(--danger-color);
            display: block;
        }

        .validation-message i {
            margin-right: 10px;
            font-size: 1.2rem;
        }

        /* Payment Section */
        .payment-section {
            padding: 100px 0;
            display: none;
        }

        .payment-header {
            text-align: center;
            margin-bottom: 50px;
        }

        .payment-header h2 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .payment-header p {
            font-size: 1.1rem;
            color: var(--text-color);
        }

        /* Pricing Section (without buttons) */
        .pricing-section {
            padding: 100px 0;
            background: white;
        }

        .pricing-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 30px;
            max-width: 1000px;
            margin: 0 auto;
        }

        .pricing-card {
            background: white;
            border-radius: 15px;
            padding: 40px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.08);
            transition: all 0.3s ease;
            position: relative;
            border: 2px solid transparent;
        }

        .pricing-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.12);
        }

        .pricing-card.popular {
            border-color: var(--secondary-color);
        }

        .popular-badge {
            position: absolute;
            top: -15px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--secondary-color);
            color: white;
            padding: 8px 30px;
            border-radius: 25px;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .pricing-card h3 {
            font-size: 1.8rem;
            margin-bottom: 20px;
        }

        .price {
            font-size: 3.5rem;
            font-weight: 700;
            color: var(--primary-color);
            margin: 20px 0;
        }

        .popular .price {
            color: var(--secondary-color);
        }

        .pricing-features {
            list-style: none;
            padding: 0;
            margin: 30px 0;
            text-align: left;
        }

        .pricing-features li {
            padding: 12px 0;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
        }

        .pricing-features li:last-child {
            border-bottom: none;
        }

        .pricing-features i {
            margin-right: 15px;
            font-size: 1.2rem;
        }

        .feature-included i {
            color: var(--success-color);
        }

        .feature-excluded i {
            color: var(--danger-color);
        }

        .pricing-features span {
            flex: 1;
        }

        /* Stripe Button Container */
        .stripe-button-container {
            margin-top: 20px;
            min-height: 50px;
        }

        .stripe-button-container stripe-buy-button {
            width: 100%;
        }

        /* How to Order Section */
        .how-to-order-section {
            padding: 100px 0;
            background: white;
        }

        .steps-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 30px;
            margin-top: 50px;
        }

        .step-card {
            background: white;
            padding: 40px 30px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.08);
            position: relative;
            transition: transform 0.3s ease;
        }

        .step-card:hover {
            transform: translateY(-10px);
        }

        .step-number {
            width: 60px;
            height: 60px;
            background: var(--primary-color);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            font-weight: 600;
            margin: 0 auto 25px;
        }

        .step-card h4 {
            margin-bottom: 15px;
            color: var(--heading-color);
        }

        /* Contact Section */
        .contact-section {
            padding: 100px 0;
            background: var(--bg-color);
        }

        .contact-form {
            background: white;
            padding: 50px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.08);
        }

        .form-control {
            padding: 15px;
            border: 2px solid var(--border-color);
            border-radius: 10px;
            margin-bottom: 20px;
            transition: all 0.3s ease;
            font-size: 1rem;
        }

        .form-control:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(10, 36, 99, 0.1);
        }

        textarea.form-control {
            min-height: 150px;
            resize: vertical;
        }

        /* Contact Info Cards */
        .contact-info-card {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.08);
            margin-bottom: 30px;
            text-align: center;
            transition: transform 0.3s ease;
        }

        .contact-info-card:hover {
            transform: translateY(-5px);
        }

        .contact-info-card i {
            font-size: 2.5rem;
            color: var(--primary-color);
            margin-bottom: 20px;
        }

        .contact-info-card h4 {
            margin-bottom: 15px;
            color: var(--heading-color);
        }

        /* Footer */
        .footer {
            background: var(--heading-color);
            color: white;
            padding: 60px 0 30px;
            margin-top: 0;
        }

        .footer-links {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 30px;
            margin-bottom: 40px;
        }

        .footer-links a {
            color: #e2e8f0;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s ease;
        }

        .footer-links a:hover {
            color: var(--secondary-color);
        }

        .footer-copyright {
            text-align: center;
            padding-top: 30px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            color: #a0aec0;
            font-size: 0.9rem;
        }

        /* Alert Messages */
        .alert {
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border: none;
        }

        .alert-success {
            background-color: #d1fae5;
            color: #065f46;
        }

        .alert-danger {
            background-color: #fee2e2;
            color: #991b1b;
        }

        /* Custom Chatbot Styling */
        .chatbot-widget {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
            font-family: 'Lexend', sans-serif;
        }

        .chatbot-toggle {
            width: 60px;
            height: 60px;
            background: var(--primary-color);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(10, 36, 99, 0.3);
            transition: all 0.3s ease;
            border: none;
        }

        .chatbot-toggle:hover {
            background: #081c4a;
            transform: scale(1.1);
        }

        .chatbot-container {
            width: 350px;
            height: 500px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
            display: none;
            flex-direction: column;
            overflow: hidden;
            margin-bottom: 15px;
        }

        .chatbot-container.active {
            display: flex;
        }

        .chatbot-header {
            background: var(--primary-color);
            color: white;
            padding: 15px 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .chatbot-header h4 {
            margin: 0;
            font-weight: 600;
        }

        .chatbot-close {
            background: none;
            border: none;
            color: white;
            font-size: 20px;
            cursor: pointer;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: background 0.3s ease;
        }

        .chatbot-close:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .chatbot-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            background: #f8f9fa;
        }

        .message {
            margin-bottom: 15px;
            display: flex;
        }

        .message.bot {
            justify-content: flex-start;
        }

        .message.user {
            justify-content: flex-end;
        }

        .message-content {
            max-width: 80%;
            padding: 12px 16px;
            border-radius: 18px;
            line-height: 1.4;
        }

        .message.bot .message-content {
            background: white;
            color: var(--text-color);
            border: 1px solid var(--border-color);
        }

        .message.user .message-content {
            background: var(--primary-color);
            color: white;
        }

        .chatbot-input {
            padding: 15px;
            border-top: 1px solid var(--border-color);
            display: flex;
            background: white;
        }

        .chatbot-input input {
            flex: 1;
            padding: 12px 15px;
            border: 1px solid var(--border-color);
            border-radius: 25px;
            font-size: 0.95rem;
            outline: none;
            transition: border 0.3s ease;
        }

        .chatbot-input input:focus {
            border-color: var(--primary-color);
        }

        .chatbot-input button {
            background: var(--primary-color);
            color: white;
            border: none;
            border-radius: 50%;
            width: 45px;
            height: 45px;
            margin-left: 10px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.3s ease;
        }

        .chatbot-input button:hover {
            background: #081c4a;
        }

        .typing-indicator {
            display: flex;
            padding: 10px 0;
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            background: #ccc;
            border-radius: 50%;
            margin: 0 3px;
            animation: typing 1.4s infinite ease-in-out;
        }

        .typing-dot:nth-child(1) { animation-delay: -0.32s; }
        .typing-dot:nth-child(2) { animation-delay: -0.16s; }

        @keyframes typing {
            0%, 80%, 100% { transform: scale(0.8); opacity: 0.5; }
            40% { transform: scale(1); opacity: 1; }
        }

        /* Responsive Styles */
        @media (max-width: 768px) {
            .vin-search-container h1 {
                font-size: 2.2rem;
            }
            .vin-form {
                flex-direction: column;
            }
            .pricing-cards {
                grid-template-columns: 1fr;
            }
            .footer-links {
                flex-direction: column;
                align-items: center;
                gap: 20px;
            }
            .contact-form {
                padding: 30px 20px;
            }
            
            /* Responsive Chatbot */
            .chatbot-widget {
                bottom: 10px;
                right: 10px;
                left: 10px;
            }
            
            .chatbot-toggle {
                width: 50px;
                height: 50px;
                font-size: 20px;
                position: fixed;
                bottom: 10px;
                right: 10px;
            }
            
            .chatbot-container {
                width: 100%;
                height: 400px;
                max-height: 80vh;
                position: fixed;
                bottom: 70px;
                right: 10px;
                left: 10px;
                margin: 0 auto;
                border-radius: 10px;
            }
            
            .chatbot-container.active {
                display: flex;
            }
            
            .chatbot-messages {
                padding: 15px;
            }
            
            .message-content {
                max-width: 85%;
                padding: 10px 14px;
                font-size: 0.9rem;
            }
            
            .chatbot-input {
                padding: 10px;
            }
            
            .chatbot-input input {
                padding: 10px 12px;
                font-size: 0.9rem;
            }
            
            .chatbot-input button {
                width: 40px;
                height: 40px;
            }
        }

        /* Extra small devices */
        @media (max-width: 480px) {
            .chatbot-container {
                height: 350px;
            }
            
            .chatbot-messages {
                padding: 12px;
            }
            
            .message-content {
                max-width: 90%;
                padding: 8px 12px;
                font-size: 0.85rem;
            }
            
            .chatbot-header h4 {
                font-size: 1rem;
            }
        }

        /* Landscape mode for mobile */
        @media (max-height: 600px) and (max-width: 768px) {
            .chatbot-container {
                height: 300px;
            }
        }

        /* Modal Styling */
        .modal-content {
            border-radius: 15px;
            border: none;
        }

        .modal-header {
            background: var(--primary-color);
            color: white;
            border-radius: 15px 15px 0 0;
            padding: 25px 30px;
        }

        .modal-title {
            color: white;
            font-size: 1.5rem;
        }

        .modal-body {
            padding: 30px;
            max-height: 400px;
            overflow-y: auto;
        }

        .btn-close {
            background: transparent url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='%23fff'%3e%3cpath d='M.293.293a1 1 0 011.414 0L8 6.586 14.293.293a1 1 0 111.414 1.414L9.414 8l6.293 6.293a1 1 0 01-1.414 1.414L8 9.414l-6.293 6.293a1 1 0 01-1.414-1.414L6.586 8 .293 1.707a1 1 0 010-1.414z'/%3e%3c/svg%3e") center/1em auto no-repeat;
            opacity: 0.8;
        }

        .btn-close:hover {
            opacity: 1;
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg fixed-top">
        <div class="container">
            <a class="navbar-brand" href="index.html">Car<span>Used</span></a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <i class="fas fa-bars"></i>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <div class="navbar-nav ms-auto">
                    <a class="nav-link" href="#home">Home</a>
                    <a class="nav-link" href="#pricing">Pricing</a>
                    <a class="nav-link" href="#how-to-order">How to Order</a>
                    <a class="nav-link" href="#contact">Contact Us</a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Home Section -->
    <section id="home">
        <!-- VIN Search Section -->
        <div class="vin-search-section">
            <div class="container">
                <div class="vin-search-container">
                    <h1>Get Your Vehicle History Report</h1>
                    <p>Enter your VIN to check vehicle history and get detailed reports</p>
                    
                    <div class="vin-form">
                        <input type="text" class="vin-input" placeholder="Enter 17-character VIN (e.g., JHLRW2H5XKX010064)" id="vinInput">
                        <button class="btn btn-primary" id="searchVinBtn">
                            <i class="fas fa-search"></i> Check Vehicle
                        </button>
                    </div>
                    
                    <!-- Validation Message Container -->
                    <div id="validationMessage" class="validation-message">
                        <i id="validationIcon"></i>
                        <span id="validationText"></span>
                    </div>
                    
                    <p class="mt-3" style="opacity: 0.8;">Your VIN is located on your dashboard or driver's side door jamb</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Payment Section (Hidden until VIN is entered) -->
    <section id="payment-section" class="payment-section">
        <div class="container">
            <div class="payment-header">
                <h2>Select Your Report Type</h2>
                <p>Choose the report that best fits your needs for VIN: <strong id="payment-vin"></strong></p>
            </div>
            
            <div class="pricing-cards">
                <div class="pricing-card">
                    <h3>Regular Report</h3>
                    <div class="price">$19.99</div>
                    <p>Basic vehicle information and specifications</p>
                    
                    <ul class="pricing-features">
                        <li class="feature-included">
                            <i class="fas fa-check-circle"></i>
                            <span>Vehicle Specifications</span>
                        </li>
                        <li class="feature-included">
                            <i class="fas fa-check-circle"></i>
                            <span>Basic History Check</span>
                        </li>
                        <li class="feature-included">
                            <i class="fas fa-check-circle"></i>
                            <span>Dimensions & Weights</span>
                        </li>
                        <li class="feature-included">
                            <i class="fas fa-check-circle"></i>
                            <span>Manufacturer Pricing</span>
                        </li>
                        <li class="feature-excluded">
                            <i class="fas fa-times-circle"></i>
                            <span>Accident History</span>
                        </li>
                        <li class="feature-excluded">
                            <i class="fas fa-times-circle"></i>
                            <span>Sales Records</span>
                        </li>
                        <li class="feature-excluded">
                            <i class="fas fa-times-circle"></i>
                            <span>Detailed Service History</span>
                        </li>
                    </ul>
                    
                    <!-- Stripe Button Container for Regular Report -->
                    <div class="stripe-button-container" id="stripe-button-container-regular">
                        <stripe-buy-button
                            buy-button-id="buy_btn_1SfQa9FiAep3lhtUT3XublXz"
                            publishable-key="pk_live_Z3DOEXDkQ29anfNUNNsk2XNb"
                        >
                        </stripe-buy-button>
                    </div>
                    <p class="mt-2" style="font-size: 0.9rem; color: var(--text-color);">
                        After payment, you'll be redirected to view your report.
                    </p>
                </div>
                
                <!-- Premium Report Card (TEST MODE) -->
                <div class="pricing-card popular">
                    <div class="popular-badge">TEST MODE</div>
                    <h3>Premium Report - TEST</h3>
                    <div class="price">$29.99</div>
                    <p>Complete vehicle history and detailed analysis</p>
                    
                    <ul class="pricing-features">
                        <li class="feature-included">
                            <i class="fas fa-check-circle"></i>
                            <span>Everything in Regular Report</span>
                        </li>
                        <li class="feature-included">
                            <i class="fas fa-check-circle"></i>
                            <span>Complete Accident History</span>
                        </li>
                        <li class="feature-included">
                            <i class="fas fa-check-circle"></i>
                            <span>Detailed Sales Records</span>
                        </li>
                        <li class="feature-included">
                            <i class="fas fa-check-circle"></i>
                            <span>Theft & Title Records</span>
                        </li>
                        <li class="feature-included">
                            <i class="fas fa-check-circle"></i>
                            <span>Service History</span>
                        </li>
                        <li class="feature-included">
                            <i class="fas fa-check-circle"></i>
                            <span>Odometer Verification</span>
                        </li>
                        <li class="feature-included">
                            <i class="fas fa-check-circle"></i>
                            <span>Priority Support</span>
                        </li>
                    </ul>
                    
                    <!-- TEST PAYMENT BUTTON (Your new sandbox button) -->
                    <div class="stripe-button-container" id="stripe-button-container-premium">
                        <stripe-buy-button
                            buy-button-id="buy_btn_1Sg8ijFgJ4riDAJpm0GS6Gfy"
                            publishable-key="pk_test_51Sg8RWFgJ4riDAJpAoM71KB6U1vZAxEJDQ9oaljCsQyskXMssyhexp5AwubX309bGLEcYfoXHfL0xDY9rhB46tO700ajSHYVeN"
                        >
                        </stripe-buy-button>
                    </div>
                    <p class="mt-2" style="font-size: 0.9rem; color: var(--text-color);">
                        ‚ö†Ô∏è <strong>TEST MODE ACTIVE</strong> - Use card <code>4242 4242 4242 4242</code>
                    </p>
                </div>
                
                <!--
                    ORIGINAL PREMIUM REPORT CARD (COMMENTED OUT)
                    Keep this safe to restore when going live!
                    
                <div class="pricing-card popular">
                    <div class="popular-badge">MOST POPULAR</div>
                    <h3>Premium Report</h3>
                    <div class="price">$29.99</div>
                    <p>Complete vehicle history and detailed analysis</p>
                    
                    <ul class="pricing-features">
                        <li class="feature-included">
                            <i class="fas fa-check-circle"></i>
                            <span>Everything in Regular Report</span>
                        </li>
                        <li class="feature-included">
                            <i class="fas fa-check-circle"></i>
                            <span>Complete Accident History</span>
                        </li>
                        <li class="feature-included">
                            <i class="fas fa-check-circle"></i>
                            <span>Detailed Sales Records</span>
                        </li>
                        <li class="feature-included">
                            <i class="fas fa-check-circle"></i>
                            <span>Theft & Title Records</span>
                        </li>
                        <li class="feature-included">
                            <i class="fas fa-check-circle"></i>
                            <span>Service History</span>
                        </li>
                        <li class="feature-included">
                            <i class="fas fa-check-circle"></i>
                            <span>Odometer Verification</span>
                        </li>
                        <li class="feature-included">
                            <i class="fas fa-check-circle"></i>
                            <span>Priority Support</span>
                        </li>
                    </ul>
                    
                    <div class="stripe-button-container" id="stripe-button-container-premium">
                        <stripe-buy-button
                            buy-button-id="buy_btn_1SflukFiAep3lhtU82vX7Y5S"
                            publishable-key="pk_live_Z3DOEXDkQ29anfNUNNsk2XNb"
                        >
                        </stripe-buy-button>
                    </div>
                    <p class="mt-2" style="font-size: 0.9rem; color: var(--text-color);">
                        After payment, you'll be redirected to view your report.
                    </p>
                </div>
                -->
            </div>
        </div>
    </section>

    <!-- Pricing Section (Always visible, without buy buttons) -->
    <section id="pricing" class="pricing-section">
        <div class="container">
            <div class="section-title text-center">
                <h2>Our Pricing Plans</h2>
                <p class="lead">Choose the perfect report for your needs. No hidden fees, no surprises.</p>
            </div>
            
            <div class="pricing-cards">
                <div class="pricing-card">
                    <h3>Regular Report</h3>
                    <div class="price">$19.99</div>
                    <p>Basic vehicle information and specifications</p>
                    
                    <ul class="pricing-features">
                        <li class="feature-included">
                            <i class="fas fa-check-circle"></i>
                            <span>Vehicle Specifications</span>
                        </li>
                        <li class="feature-included">
                            <i class="fas fa-check-circle"></i>
                            <span>Basic History Check</span>
                        </li>
                        <li class="feature-included">
                            <i class="fas fa-check-circle"></i>
                            <span>Dimensions & Weights</span>
                        </li>
                        <li class="feature-included">
                            <i class="fas fa-check-circle"></i>
                            <span>Manufacturer Pricing</span>
                        </li>
                        <li class="feature-excluded">
                            <i class="fas fa-times-circle"></i>
                            <span>Accident History</span>
                        </li>
                        <li class="feature-excluded">
                            <i class="fas fa-times-circle"></i>
                            <span>Sales Records</span>
                        </li>
                        <li class="feature-excluded">
                            <i class="fas fa-times-circle"></i>
                            <span>Detailed Service History</span>
                        </li>
                    </ul>
                    
                    <div class="text-center mt-4">
                        <a href="#home" class="btn btn-primary btn-lg">
                            <i class="fas fa-car"></i> Get Started
                        </a>
                        <p class="mt-2" style="font-size: 0.9rem; color: var(--text-color);">
                            Enter your VIN above to purchase
                        </p>
                    </div>
                </div>
                
                <!-- Premium Report Card for Pricing Section (TEST MODE) -->
                <div class="pricing-card popular">
                    <div class="popular-badge">TEST MODE</div>
                    <h3>Premium Report - TEST</h3>
                    <div class="price">$29.99</div>
                    <p>Complete vehicle history and detailed analysis</p>
                    
                    <ul class="pricing-features">
                        <li class="feature-included">
                            <i class="fas fa-check-circle"></i>
                            <span>Everything in Regular Report</span>
                        </li>
                        <li class="feature-included">
                            <i class="fas fa-check-circle"></i>
                            <span>Complete Accident History</span>
                        </li>
                        <li class="feature-included">
                            <i class="fas fa-check-circle"></i>
                            <span>Detailed Sales Records</span>
                        </li>
                        <li class="feature-included">
                            <i class="fas fa-check-circle"></i>
                            <span>Theft & Title Records</span>
                        </li>
                        <li class="feature-included">
                            <i class="fas fa-check-circle"></i>
                            <span>Service History</span>
                        </li>
                        <li class="feature-included">
                            <i class="fas fa-check-circle"></i>
                            <span>Odometer Verification</span>
                        </li>
                        <li class="feature-included">
                            <i class="fas fa-check-circle"></i>
                            <span>Priority Support</span>
                        </li>
                    </ul>
                    
                    <!-- TEST PAYMENT BUTTON (Your new sandbox button) -->
                    <div class="stripe-button-container" id="stripe-button-container-premium-pricing">
                        <stripe-buy-button
                            buy-button-id="buy_btn_1Sg8ijFgJ4riDAJpm0GS6Gfy"
                            publishable-key="pk_test_51Sg8RWFgJ4riDAJpAoM71KB6U1vZAxEJDQ9oaljCsQyskXMssyhexp5AwubX309bGLEcYfoXHfL0xDY9rhB46tO700ajSHYVeN"
                        >
                        </stripe-buy-button>
                    </div>
                    <p class="mt-2" style="font-size: 0.9rem; color: var(--text-color);">
                        ‚ö†Ô∏è <strong>TEST MODE ACTIVE</strong> - Use card <code>4242 4242 4242 4242</code>
                    </p>
                </div>
                
                <!--
                    ORIGINAL PREMIUM REPORT CARD FOR PRICING SECTION (COMMENTED OUT)
                    
                <div class="pricing-card popular">
                    <div class="popular-badge">MOST POPULAR</div>
                    <h3>Premium Report</h3>
                    <div class="price">$29.99</div>
                    <p>Complete vehicle history and detailed analysis</p>
                    
                    <ul class="pricing-features">
                        <li class="feature-included">
                            <i class="fas fa-check-circle"></i>
                            <span>Everything in Regular Report</span>
                        </li>
                        <li class="feature-included">
                            <i class="fas fa-check-circle"></i>
                            <span>Complete Accident History</span>
                        </li>
                        <li class="feature-included">
                            <i class="fas fa-check-circle"></i>
                            <span>Detailed Sales Records</span>
                        </li>
                        <li class="feature-included">
                            <i class="fas fa-check-circle"></i>
                            <span>Theft & Title Records</span>
                        </li>
                        <li class="feature-included">
                            <i class="fas fa-check-circle"></i>
                            <span>Service History</span>
                        </li>
                        <li class="feature-included">
                            <i class="fas fa-check-circle"></i>
                            <span>Odometer Verification</span>
                        </li>
                        <li class="feature-included">
                            <i class="fas fa-check-circle"></i>
                            <span>Priority Support</span>
                        </li>
                    </ul>
                    
                    <div class="text-center mt-4">
                        <a href="#home" class="btn btn-primary btn-lg">
                            <i class="fas fa-crown"></i> Get Premium
                        </a>
                        <p class="mt-2" style="font-size: 0.9rem; color: var(--text-color);">
                            Enter your VIN above to purchase
                        </p>
                    </div>
                </div>
                -->
            </div>
            
            <div class="text-center mt-5">
                <div class="row justify-content-center">
                    <div class="col-lg-8">
                        <div class="alert alert-light" style="border-left: 5px solid var(--primary-color);">
                            <h5><i class="fas fa-info-circle text-primary me-2"></i> What's Included in All Reports</h5>
                            <p class="mb-0">Both reports include instant digital delivery, 24/7 access to your report, and our 100% satisfaction guarantee. All reports are generated from official databases and updated in real-time.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- How to Order Section -->
    <section id="how-to-order" class="how-to-order-section">
        <div class="container">
            <div class="section-title text-center">
                <h2>How to Order</h2>
                <p class="lead">Get your vehicle history report in 3 simple steps</p>
            </div>
            
            <div class="steps-container">
                <div class="step-card">
                    <div class="step-number">1</div>
                    <h4>Enter Your VIN</h4>
                    <p>Locate your 17-character Vehicle Identification Number on your dashboard, door jamb, or registration documents and enter it above.</p>
                </div>
                
                <div class="step-card">
                    <div class="step-number">2</div>
                    <h4>Select Report Type</h4>
                    <p>Choose between our Regular Report ($19.99) for basic information or Premium Report ($29.99) for comprehensive history including accidents, sales records, and more.</p>
                </div>
                
                <div class="step-card">
                    <div class="step-number">3</div>
                    <h4>Complete Payment</h4>
                    <p>Click the Stripe button for your chosen report. You'll be redirected to complete your payment securely. After payment, you'll view your report.</p>
                </div>
            </div>
            
            <div class="text-center mt-5">
                <p class="mb-3"><strong>Note:</strong> All reports are delivered digitally. No physical copies are mailed.</p>
                <a href="#home" class="btn btn-primary">Get Started Now</a>
            </div>
        </div>
    </section>

    <!-- Contact Section -->
    <section id="contact" class="contact-section">
        <div class="container">
            <div class="section-title text-center">
                <h2>Contact Us</h2>
                <p class="lead">Have questions? Get in touch with our team</p>
            </div>
            
            <div class="row">
                <div class="col-lg-4">
                    <div class="contact-info-card">
                        <i class="fas fa-phone"></i>
                        <h4>Phone</h4>
                        <p><strong>+1 (858) 651-5050</strong></p>
                        <p>Monday - Friday: 9:00 AM - 6:00 PM EST</p>
                        <p>Saturday: 10:00 AM - 4:00 PM EST</p>
                    </div>
                    
                    <div class="contact-info-card">
                        <i class="fas fa-map-marker-alt"></i>
                        <h4>Address</h4>
                        <p><strong>93 Lombard Ave</strong></p>
                        <p>Winnipeg, Manitoba</p>
                        <p>Canada R3B 0T4</p>
                    </div>
                </div>
                
                <div class="col-lg-8">
                    <div class="contact-form">
                        <div id="form-message" style="display: none;"></div>
                        
                        <!-- Google Apps Script Form -->
                        <form id="contactForm" method="POST">
                            <div class="row">
                                <div class="col-md-6">
                                    <input type="text" class="form-control" id="name" name="name" placeholder="Your Name" required>
                                </div>
                                <div class="col-md-6">
                                    <input type="email" class="form-control" id="email" name="email" placeholder="Your Email" required>
                                </div>
                            </div>
                            
                            <input type="text" class="form-control" id="subject" name="subject" placeholder="Subject" required>
                            
                            <textarea class="form-control" id="message" name="message" placeholder="Your Message" required></textarea>
                            
                            <div class="text-center">
                                <button type="button" class="btn btn-primary btn-lg" id="submit-btn">
                                    <i class="fas fa-paper-plane"></i> Send Message
                                </button>
                            </div>
                        </form>
                        
                        <p class="text-center mt-4" style="font-size: 0.9rem; color: var(--text-color);">
                            <i class="fas fa-info-circle"></i> All messages are sent directly to our team via Gmail.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-links">
                <a href="#" data-bs-toggle="modal" data-bs-target="#privacyModal">Privacy Policy</a>
                <a href="#" data-bs-toggle="modal" data-bs-target="#refundModal">Refund Policy</a>
                <a href="#pricing">Pricing</a>
                <a href="#how-to-order">How to Order</a>
                <a href="#contact">Contact Us</a>
            </div>
            
            <div class="footer-copyright">
                <p>&copy; 2024 CarUsed. All rights reserved. | Vehicle reports are for informational purposes only.</p>
            </div>
        </div>
    </footer>

    <!-- Custom Chatbot Widget -->
    <div class="chatbot-widget">
        <div class="chatbot-container" id="chatbotContainer">
            <div class="chatbot-header">
                <h4><i class="fas fa-robot me-2"></i> James - CarUsed Assistant</h4>
                <button class="chatbot-close" id="chatbotClose">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="chatbot-messages" id="chatbotMessages">
                <!-- Messages will appear here -->
                <div class="message bot">
                    <div class="message-content">
                        <strong>üëã Welcome to CarUsed!</strong><br><br>
                        Hello! I'm <strong>James</strong>, your CarUsed assistant. üòä<br><br>
                        I'm here to help you with any questions about our vehicle history reports, pricing, how to order, or anything else you need.<br><br>
                        Feel free to ask me anything ‚Äì I'm here to help make your vehicle research easy and stress-free!
                    </div>
                </div>
            </div>
            <div class="chatbot-input">
                <input type="text" id="chatbotInput" placeholder="Type your question here..." autocomplete="off">
                <button id="chatbotSend">
                    <i class="fas fa-paper-plane"></i>
                </button>
            </div>
        </div>
        <button class="chatbot-toggle" id="chatbotToggle">
            <i class="fas fa-comment-dots"></i>
        </button>
    </div>

    <!-- Refund Policy Modal -->
    <div class="modal fade" id="refundModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Refund Policy</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <h4>Digital Product Refund Policy</h4>
                    <p><strong>Last Updated: January 1, 2024</strong></p>
                    
                    <h5 class="mt-4">1. No Refunds for Digital Downloads</h5>
                    <p>Due to the nature of digital products, all sales of vehicle history reports are final. Once a report has been accessed, downloaded, or delivered via email, no refunds will be issued under any circumstances.</p>
                    
                    <h5 class="mt-4">2. Product Description</h5>
                    <p>We provide detailed descriptions of our Regular ($19.99) and Premium ($29.99) reports on our website. Customers are responsible for reviewing these descriptions before purchase. Refunds will not be granted based on customer expectations that differ from the product description.</p>
                    
                    <h5 class="mt-4">3. Technical Issues</h5>
                    <p>If you experience technical difficulties accessing your report, please contact our support team at +1 (858) 651-5050. We will work to resolve any legitimate technical issues but cannot issue refunds for reports that have been successfully delivered to your email address.</p>
                    
                    <h5 class="mt-4">4. Data Accuracy Disclaimer</h5>
                    <p>Our reports compile information from various sources. While we strive for accuracy, we cannot guarantee the completeness or accuracy of the information provided. Refunds will not be issued based on the content or accuracy of the information in reports.</p>
                    
                    <h5 class="mt-4">5. Unauthorized Purchases</h5>
                    <p>If you believe your purchase was unauthorized, you must contact us within 24 hours of the purchase date. We will investigate and may issue a refund at our discretion if the claim is validated.</p>
                    
                    <h5 class="mt-4">6. Customer Responsibility</h5>
                    <p>Customers are responsible for ensuring they enter the correct VIN number before purchase. No refunds will be issued for reports generated with incorrect VIN numbers provided by the customer.</p>
                    
                    <h5 class="mt-4">7. Contact Information</h5>
                    <p>For any questions about this policy, please contact us at:</p>
                    <ul>
                        <li>Phone: +1 (858) 651-5050</li>
                        <li>Business Hours: Monday-Friday, 9AM-5PM EST</li>
                    </ul>
                    
                    <div class="alert alert-warning mt-4">
                        <strong>Important:</strong> By purchasing any report from CarUsed, you acknowledge and agree to this no-refund policy for digital products.
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Privacy Policy Modal -->
    <div class="modal fade" id="privacyModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Privacy Policy</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <h4>Privacy Policy</h4>
                    <p><strong>Last Updated: January 1, 2024</strong></p>
                    <p>CarUsed respects your privacy and is committed to protecting your personal data. This privacy policy will inform you about how we look after your personal data when you visit our website and tell you about your privacy rights.</p>
                    
                    <h5 class="mt-4">Information We Collect</h5>
                    <p>We collect information you provide directly to us, such as when you request a vehicle report, create an account, or contact us for support.</p>
                    
                    <h5 class="mt-4">How We Use Your Information</h5>
                    <p>We use the information we collect to provide, maintain, and improve our services, to process transactions, and to communicate with you.</p>
                    
                    <h5 class="mt-4">Data Security</h5>
                    <p>We implement appropriate technical and organizational measures to protect your personal data against unauthorized access, alteration, disclosure, or destruction.</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Add Bootstrap JS for modals and navbar toggle
        const bootstrapScript = document.createElement('script');
        bootstrapScript.src = 'https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js';
        document.head.appendChild(bootstrapScript);

        // DOM Elements
        const vinInput = document.getElementById('vinInput');
        const searchVinBtn = document.getElementById('searchVinBtn');
        const paymentSection = document.getElementById('payment-section');
        const paymentVin = document.getElementById('payment-vin');
        const contactForm = document.getElementById('contactForm');
        const formMessage = document.getElementById('form-message');
        const submitBtn = document.getElementById('submit-btn');
        const validationMessage = document.getElementById('validationMessage');
        const validationIcon = document.getElementById('validationIcon');
        const validationText = document.getElementById('validationText');

        // Chatbot DOM Elements
        const chatbotToggle = document.getElementById('chatbotToggle');
        const chatbotContainer = document.getElementById('chatbotContainer');
        const chatbotClose = document.getElementById('chatbotClose');
        const chatbotMessages = document.getElementById('chatbotMessages');
        const chatbotInput = document.getElementById('chatbotInput');
        const chatbotSend = document.getElementById('chatbotSend');

        // State variables
        let currentVin = '';
        let isFirstInteraction = true;

        // Database of valid VINs (simulating your vehicle database)
        // In a real application, this would be an API call to your backend
        const validVINsInDatabase = [
            'JHLRW2H5XKX010064',  // Example valid VIN 1
            '1HGCM82633A123456',  // Example valid VIN 2
            '2HGCM82633A123457',  // Example valid VIN 3
            '3VWDP7AJ7DM123456',  // Example valid VIN 4
            'WBA3B9C59DF123456',  // Example valid VIN 5
            '1FAHP3F20CL123456',  // Example valid VIN 6
            '5YJSA1E21HF123456',  // Example valid VIN 7
            'KM8JN72DX7U123456',  // Example valid VIN 8
            '1G1JC5244X7123456',  // Example valid VIN 9
            '5FNRL386X8B123456'   // Example valid VIN 10
        ];

        // Fake or invalid VIN patterns
        const fakeVINPatterns = [
            '11111111111111111',
            '22222222222222222',
            '33333333333333333',
            'AAAAAAAAAAAAAAAAA',
            'BBBBBBBBBBBBBBBBB',
            '12345678901234567'
        ];

        // Validate VIN format
        function validateVINFormat(vin) {
            return vin.length === 17 && /^[A-HJ-NPR-Z0-9]{17}$/i.test(vin);
        }

        // Check if VIN exists in database
        function checkVINInDatabase(vin) {
            const normalizedVIN = vin.toUpperCase();
            
            // Check if it's a fake pattern
            if (fakeVINPatterns.includes(normalizedVIN)) {
                return {
                    exists: false,
                    message: 'This VIN appears to be fake or invalid. Please enter a valid Vehicle Identification Number.',
                    type: 'invalid'
                };
            }
            
            // Check if it exists in the database
            if (validVINsInDatabase.includes(normalizedVIN)) {
                return {
                    exists: true,
                    message: '‚úì Valid VIN found! Vehicle information is available.',
                    type: 'valid'
                };
            } else {
                return {
                    exists: false,
                    message: '‚úó This VIN was not found in our database. Please check the VIN and try again.',
                    type: 'not_found'
                };
            }
        }

        // Show validation message
        function showValidationMessage(message, type) {
            validationMessage.className = 'validation-message';
            validationIcon.className = '';
            validationText.textContent = message;
            
            if (type === 'valid') {
                validationMessage.classList.add('valid');
                validationIcon.className = 'fas fa-check-circle';
            } else {
                validationMessage.classList.add('invalid');
                validationIcon.className = 'fas fa-exclamation-circle';
            }
            
            // Auto-hide after 10 seconds for invalid VINs
            if (type !== 'valid') {
                setTimeout(() => {
                    validationMessage.style.display = 'none';
                }, 10000);
            }
        }

        // Hide validation message
        function hideValidationMessage() {
            validationMessage.style.display = 'none';
        }

        // Show payment options
        function showPaymentOptions(vin) {
            // First, hide any previous validation messages
            hideValidationMessage();
            
            // Validate VIN format
            if (!validateVINFormat(vin)) {
                showValidationMessage('‚úó Please enter a valid 17-character VIN. VIN should contain only letters and numbers (except I, O, Q).', 'invalid');
                return;
            }
            
            // Show checking message
            showValidationMessage('üîç Checking VIN in our database...', 'checking');
            
            // Simulate database check (in real app, this would be an API call)
            setTimeout(() => {
                const vinCheck = checkVINInDatabase(vin);
                
                if (vinCheck.exists) {
                    // VIN is valid and exists in database
                    currentVin = vin.toUpperCase();
                    paymentVin.textContent = currentVin;
                    paymentSection.style.display = 'block';
                    
                    // Store VIN in sessionStorage for later use
                    sessionStorage.setItem('carUsed_vin', currentVin);
                    
                    // Show success message
                    showValidationMessage(vinCheck.message, 'valid');
                    
                    // Scroll to payment section
                    paymentSection.scrollIntoView({ behavior: 'smooth' });
                } else {
                    // VIN not found or invalid
                    showValidationMessage(vinCheck.message, 'invalid');
                    
                    // Hide payment section
                    paymentSection.style.display = 'none';
                }
            }, 1500); // Simulate 1.5 second database check
        }

        // Contact Form Submission using Google Apps Script
        submitBtn.addEventListener('click', async function(e) {
            e.preventDefault();
            
            // Get form data
            const formData = {
                name: document.getElementById('name').value,
                email: document.getElementById('email').value,
                subject: document.getElementById('subject').value,
                message: document.getElementById('message').value,
                to_email: 'christiantelemaque@gmail.com',
                subject_prefix: 'CarUsed Contact Form: '
            };
            
            // Validate form
            if (!formData.name || !formData.email || !formData.subject || !formData.message) {
                formMessage.innerHTML = `
                    <div class="alert alert-danger">
                        <h4><i class="fas fa-exclamation-triangle"></i> Please fill in all fields</h4>
                        <p>All fields are required to send your message.</p>
                    </div>
                `;
                formMessage.style.display = 'block';
                setTimeout(() => {
                    formMessage.style.display = 'none';
                }, 5000);
                return;
            }
            
            // Show loading state
            const originalText = submitBtn.innerHTML;
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Sending...';
            submitBtn.disabled = true;
            
            try {
                // Your Google Apps Script Web App URL
                const scriptURL = 'https://script.google.com/macros/s/AKfycbzJRsWjYVUwG9q9hHpLRZKTDypHRwBPhB77YTqxydhGwCU9i3tYfU20LrHj70MfLwvoAw/exec';
                
                // Create URL encoded form data
                const formDataEncoded = new URLSearchParams();
                formDataEncoded.append('name', formData.name);
                formDataEncoded.append('email', formData.email);
                formDataEncoded.append('subject', formData.subject);
                formDataEncoded.append('message', formData.message);
                formDataEncoded.append('to_email', formData.to_email);
                formDataEncoded.append('subject_prefix', formData.subject_prefix);
                
                // Submit to Google Apps Script
                const response = await fetch(scriptURL, {
                    method: 'POST',
                    body: formDataEncoded,
                    mode: 'no-cors' // Required for Google Apps Script
                });
                
                // Since we use no-cors, we can't read the response
                // But we assume success if no error is thrown
                
                // Show success message
                formMessage.innerHTML = `
                    <div class="alert alert-success">
                        <h4><i class="fas fa-check-circle"></i> Message Sent Successfully!</h4>
                        <p>Thank you for contacting us. Your message has been sent to our team.</p>
                        <p>We'll get back to you as soon as possible at <strong>${formData.email}</strong>.</p>
                    </div>
                `;
                formMessage.style.display = 'block';
                
                // Reset form
                document.getElementById('name').value = '';
                document.getElementById('email').value = '';
                document.getElementById('subject').value = '';
                document.getElementById('message').value = '';
                
                // Scroll to message
                formMessage.scrollIntoView({ behavior: 'smooth' });
                
                // Hide message after 8 seconds
                setTimeout(() => {
                    formMessage.style.display = 'none';
                }, 8000);
                
            } catch (error) {
                console.error('Form submission error:', error);
                
                // Fallback: Direct email option
                const mailtoLink = `mailto:christiantelemaque@gmail.com?subject=${encodeURIComponent('CarUsed Contact Form: ' + formData.subject)}&body=${encodeURIComponent(`Name: ${formData.name}\nEmail: ${formData.email}\n\nMessage:\n${formData.message}`)}`;
                
                formMessage.innerHTML = `
                    <div class="alert alert-info">
                        <h4><i class="fas fa-envelope"></i> Alternative Contact Method</h4>
                        <p>You can contact us directly via email:</p>
                        <p class="mt-3"><a href="${mailtoLink}" class="btn btn-primary">Open Email Client</a></p>
                        <p class="mt-2" style="font-size: 0.9rem;">Or call us at: <strong>+1 (858) 651-5050</strong></p>
                    </div>
                `;
                formMessage.style.display = 'block';
            } finally {
                // Reset button state
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            }
        });

        // Event Listeners
        searchVinBtn.addEventListener('click', () => {
            const vin = vinInput.value.trim();
            if (vin) {
                showPaymentOptions(vin);
            } else {
                showValidationMessage('‚úó Please enter a VIN to check vehicle history.', 'invalid');
            }
        });

        // Handle VIN input Enter key
        vinInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                const vin = vinInput.value.trim();
                if (vin) {
                    showPaymentOptions(vin);
                } else {
                    showValidationMessage('‚úó Please enter a VIN to check vehicle history.', 'invalid');
                }
            }
        });

        // Clear validation message when user starts typing
        vinInput.addEventListener('input', () => {
            hideValidationMessage();
        });

        // Smooth scroll for navigation links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                
                const targetId = this.getAttribute('href');
                if (targetId === '#home') {
                    // Scroll to top
                    window.scrollTo({
                        top: 0,
                        behavior: 'smooth'
                    });
                } else {
                    const targetElement = document.querySelector(targetId);
                    if (targetElement) {
                        targetElement.scrollIntoView({
                            behavior: 'smooth'
                        });
                    }
                }
            });
        });

        // Initialize
        window.onload = () => {
            // Clear VIN input - don't auto-fill from sessionStorage
            vinInput.value = '';
            
            // Hide payment section initially
            paymentSection.style.display = 'none';
            
            // Hide validation message initially
            hideValidationMessage();
        };
        
        // Clear sessionStorage when user goes back to home page intentionally
        window.addEventListener('pageshow', function(event) {
            // If the page is being shown from cache (back/forward navigation)
            // Clear the VIN input field
            vinInput.value = '';
            hideValidationMessage();
        });

        // Set up Stripe button click handlers
        document.addEventListener('DOMContentLoaded', function() {
            // Wait for Stripe buttons to be available
            const checkStripeButtons = setInterval(function() {
                const stripeButtons = document.querySelectorAll('stripe-buy-button');
                if (stripeButtons.length >= 2) {
                    clearInterval(checkStripeButtons);
                    
                    // Add click event to regular Stripe button container
                    const regularContainer = document.getElementById('stripe-button-container-regular');
                    if (regularContainer) {
                        regularContainer.addEventListener('click', function() {
                            // Store the plan in sessionStorage when regular Stripe button is clicked
                            const vin = sessionStorage.getItem('carUsed_vin') || currentVin;
                            if (vin) {
                                sessionStorage.setItem('carUsed_plan', 'regular');
                                sessionStorage.setItem('carUsed_vin', vin);
                                console.log('Stripe button clicked for regular report, VIN:', vin);
                            }
                        });
                    }
                    
                    // Add click event to premium Stripe button container
                    const premiumContainer = document.getElementById('stripe-button-container-premium');
                    if (premiumContainer) {
                        premiumContainer.addEventListener('click', function() {
                            // Store the plan in sessionStorage when premium Stripe button is clicked
                            const vin = sessionStorage.getItem('carUsed_vin') || currentVin;
                            if (vin) {
                                sessionStorage.setItem('carUsed_plan', 'premium');
                                sessionStorage.setItem('carUsed_vin', vin);
                                console.log('Stripe button clicked for premium report, VIN:', vin);
                            }
                        });
                    }
                    
                    // Add click event to premium pricing section button
                    const premiumPricingContainer = document.getElementById('stripe-button-container-premium-pricing');
                    if (premiumPricingContainer) {
                        premiumPricingContainer.addEventListener('click', function() {
                            // Store the plan in sessionStorage when premium pricing Stripe button is clicked
                            const vin = sessionStorage.getItem('carUsed_vin') || currentVin;
                            if (vin) {
                                sessionStorage.setItem('carUsed_plan', 'premium');
                                sessionStorage.setItem('carUsed_vin', vin);
                                console.log('Stripe button clicked for premium report (pricing section), VIN:', vin);
                            }
                        });
                    }
                }
            }, 100);
        });

        // ============================================
        // CUSTOM CHATBOT FUNCTIONALITY
        // ============================================

        // Chatbot state and knowledge base
        const chatbotKnowledge = {
            // Updated answers as requested
            commonQuestions: {
                'what types of vehicle history reports do you offer': 'We offer two types of reports: a Regular Report for $19.99, which includes basic vehicle information, and a Premium Report for $29.99, which provides a complete history and detailed analysis.',
                'types of reports': 'We offer two types of reports: a Regular Report for $19.99, which includes basic vehicle information, and a Premium Report for $29.99, which provides a complete history and detailed analysis.',
                'how do i order': 'To order, enter your VIN, select the report type, and complete the payment. You\'ll be redirected to view your report after payment.',
                'how to order': 'To order, enter your VIN, select the report type, and complete the payment. You\'ll be redirected to view your report after payment.',
                'what is included in the regular report': 'The Regular Report includes vehicle specifications, basic history check, accident history, sales records, and detailed service history.',
                'regular report': 'The Regular Report includes vehicle specifications, basic history check, accident history, sales records, and detailed service history.',
                'hidden fees': 'No, there are no hidden fees. The prices for our reports are clearly stated, and you pay only the listed amount.',
                'refund': 'All sales of vehicle history reports are final. We do not issue refunds for digital downloads once accessed or delivered.',
                'customer support': 'You can reach our customer support at +1 (858) 651-5050 during business hours, or send us a message through our website.',
                'contact': 'You can reach our customer support at +1 (858) 651-5050 during business hours, or send us a message through our website.',
                'wrong vin': 'Customers are responsible for entering the correct VIN. No refunds will be issued for reports generated with incorrect VIN numbers provided by the customer.',
                'how quickly will i receive my report': 'Reports are delivered instantly in digital format, and you can access them 24/7 after payment.',
                'delivery': 'Reports are delivered instantly in digital format, and you can access them 24/7 after payment.',
                'personal information secure': 'Yes, we implement appropriate measures to protect your personal data against unauthorized access and ensure your privacy.',
                'security': 'Yes, we implement appropriate measures to protect your personal data against unauthorized access and ensure your privacy.',
                'privacy': 'Yes, we implement appropriate measures to protect your personal data against unauthorized access and ensure your privacy.',
                
                // Additional common questions
                'hello': 'Hello again! How can I assist you today? üòä',
                'hi': 'Hi there! I\'m James, your CarUsed assistant. What can I help you with?',
                'help': 'I can help you with questions about our reports, pricing, ordering process, refunds, contact information, and more. What would you like to know?',
                'price': 'We offer two pricing plans: Regular Report for $19.99 and Premium Report for $29.99.',
                'pricing': 'Our pricing is simple: Regular Report costs $19.99 and Premium Report costs $29.99.',
                'cost': 'The Regular Report is $19.99 and the Premium Report is $29.99.',
                'what is vin': 'A VIN (Vehicle Identification Number) is a 17-character unique code that identifies your vehicle. You can find it on your dashboard or driver\'s side door jamb.',
                'where is vin': 'Your VIN is located on your dashboard (visible through the windshield) or on the driver\'s side door jamb.',
                'phone': 'Our phone number is +1 (858) 651-5050. We\'re available Monday-Friday 9:00 AM - 6:00 PM EST and Saturday 10:00 AM - 4:00 PM EST.',
                'address': 'Our address is 93 Lombard Ave, Winnipeg, Manitoba, Canada R3B 0T4.',
                'report': 'We offer two types of reports: Regular ($19.99) for basic information and Premium ($29.99) for complete history including accidents, sales records, and service history.',
                'what included': 'Regular Report ($19.99): Vehicle specifications, basic history, accident history, sales records, service history. Premium Report ($29.99): Everything in Regular plus additional detailed analysis.',
                'features': 'Regular Report features: Vehicle specs, basic history, accident history, sales records, service history. Premium Report adds: Complete detailed analysis and additional vehicle data.',
                'difference': 'The main difference is that Premium Report ($29.99) provides more comprehensive analysis and additional data points compared to the Regular Report ($19.99).',
                'vin not found': 'If your VIN is not found in our database, it may be invalid, fake, or not yet registered in our system. Please double-check the VIN or contact our support team for assistance.',
                'fake vin': 'We validate all VINs against official databases. If a VIN appears fake or invalid, you\'ll receive an error message and won\'t be able to proceed with payment.',
                'database': 'We maintain a comprehensive database of vehicle information that is regularly updated from official sources to ensure accuracy and reliability.'
            },
            
            // Keywords to identify question types
            keywords: {
                'price': ['price', 'cost', 'how much', 'pricing', '$', 'fee'],
                'report': ['report', 'what\'s included', 'features', 'include', 'contain', 'regular report', 'premium report', 'types of vehicle history reports'],
                'vin': ['vin', 'vehicle identification', 'where vin', 'find vin', 'wrong vin', 'fake vin', 'vin not found', 'database'],
                'order': ['order', 'how to', 'process', 'steps', 'buy', 'purchase', 'how do i order'],
                'contact': ['contact', 'phone', 'call', 'email', 'address', 'location', 'customer support'],
                'refund': ['refund', 'return', 'money back', 'cancel'],
                'privacy': ['privacy', 'data', 'information', 'secure', 'security', 'personal information secure'],
                'greeting': ['hello', 'hi', 'hey', 'greetings'],
                'delivery': ['delivery', 'how quickly', 'when will i get', 'receive', 'instant']
            }
        };

        // Initialize chatbot
        function initChatbot() {
            // Set up event listeners
            chatbotToggle.addEventListener('click', toggleChatbot);
            chatbotClose.addEventListener('click', toggleChatbot);
            chatbotSend.addEventListener('click', sendMessage);
            chatbotInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    sendMessage();
                }
            });
            
            // Load any previous messages from localStorage
            loadChatHistory();
        }

        // Toggle chatbot visibility
        function toggleChatbot() {
            chatbotContainer.classList.toggle('active');
            if (chatbotContainer.classList.contains('active')) {
                chatbotInput.focus();
                scrollToBottom();
            }
        }

        // Send a message
        function sendMessage() {
            const message = chatbotInput.value.trim();
            if (!message) return;
            
            // Add user message to chat
            addMessage(message, 'user');
            
            // Clear input
            chatbotInput.value = '';
            
            // Show typing indicator
            showTypingIndicator();
            
            // Process and respond after 10 seconds
            setTimeout(() => {
                removeTypingIndicator();
                const response = generateResponse(message);
                addMessage(response, 'bot');
                scrollToBottom();
                
                // Save to chat history
                saveToChatHistory(message, response);
            }, 10000); // 10 seconds delay
        }

        // Add a message to the chat
        function addMessage(text, sender) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${sender}`;
            
            const contentDiv = document.createElement('div');
            contentDiv.className = 'message-content';
            
            // Add agent name for bot messages
            if (sender === 'bot') {
                const agentName = document.createElement('strong');
                agentName.textContent = 'James: ';
                agentName.style.color = 'var(--primary-color)';
                contentDiv.appendChild(agentName);
            }
            
            const messageText = document.createElement('span');
            messageText.textContent = text;
            contentDiv.appendChild(messageText);
            
            messageDiv.appendChild(contentDiv);
            chatbotMessages.appendChild(messageDiv);
            
            scrollToBottom();
        }

        // Show typing indicator
        function showTypingIndicator() {
            const typingDiv = document.createElement('div');
            typingDiv.className = 'typing-indicator';
            typingDiv.id = 'typingIndicator';
            
            const typingText = document.createElement('span');
            typingText.textContent = 'James is typing...';
            typingText.style.fontSize = '0.8rem';
            typingText.style.color = 'var(--text-color)';
            typingText.style.marginRight = '10px';
            
            typingDiv.appendChild(typingText);
            
            for (let i = 0; i < 3; i++) {
                const dot = document.createElement('div');
                dot.className = 'typing-dot';
                typingDiv.appendChild(dot);
            }
            
            chatbotMessages.appendChild(typingDiv);
            scrollToBottom();
        }

        // Remove typing indicator
        function removeTypingIndicator() {
            const typingIndicator = document.getElementById('typingIndicator');
            if (typingIndicator) {
                typingIndicator.remove();
            }
        }

        // Scroll to bottom of chat
        function scrollToBottom() {
            setTimeout(() => {
                chatbotMessages.scrollTop = chatbotMessages.scrollHeight;
            }, 100);
        }

        // Generate a response based on the user's message
        function generateResponse(userMessage) {
            const lowerMessage = userMessage.toLowerCase();
            
            // Check for exact matches in common questions
            for (const [question, answer] of Object.entries(chatbotKnowledge.commonQuestions)) {
                if (lowerMessage.includes(question.toLowerCase())) {
                    return answer;
                }
            }
            
            // Check for keyword matches
            for (const [category, keywords] of Object.entries(chatbotKnowledge.keywords)) {
                for (const keyword of keywords) {
                    if (lowerMessage.includes(keyword)) {
                        // Return the corresponding common question answer
                        const answer = chatbotKnowledge.commonQuestions[category];
                        if (answer) {
                            return answer;
                        }
                    }
                }
            }
            
            // Default response
            return "I'm not sure about that. You can ask me about our reports, pricing, how to order, refunds, or contact information. What would you like to know?";
        }

        // Save message to chat history
        function saveToChatHistory(userMessage, botResponse) {
            try {
                let chatHistory = JSON.parse(localStorage.getItem('carUsedChatHistory') || '[]');
                chatHistory.push({
                    user: userMessage,
                    bot: botResponse,
                    timestamp: new Date().toISOString()
                });
                
                // Keep only last 50 messages
                if (chatHistory.length > 50) {
                    chatHistory = chatHistory.slice(-50);
                }
                
                localStorage.setItem('carUsedChatHistory', JSON.stringify(chatHistory));
            } catch (e) {
                console.error('Error saving chat history:', e);
            }
        }

        // Load chat history from localStorage
        function loadChatHistory() {
            try {
                const chatHistory = JSON.parse(localStorage.getItem('carUsedChatHistory') || '[]');
                // We're not loading old messages by default, but the function is here if needed
            } catch (e) {
                console.error('Error loading chat history:', e);
            }
        }

        // Initialize chatbot when page loads
        document.addEventListener('DOMContentLoaded', initChatbot);

    </script>
</body>
    </html>
